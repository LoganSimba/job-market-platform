<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Job Market Intelligence Platform</title>
  <meta name="description" content="Interactive dashboard for simulated tech job data: skills demand, salaries, and company trends." />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root {
      --bg: #0b0f1a; --bg-2: #0e1424; --text: #e9ecf7; --muted: #a9b1cc;
      --brand: #7aa2ff; --brand-2: #8a5cff; --accent: #67e480;
      --glass: rgba(255,255,255,0.08); --stroke: rgba(255,255,255,0.14);
      --card: rgba(255,255,255,0.06); --shadow: 0 10px 30px rgba(0,0,0,.35);
    }
    [data-theme="light"] {
      --bg: #f7f8fc; --bg-2: #ffffff; --text: #0f1324; --muted: #4f5673;
      --brand: #4c65ff; --brand-2: #8b5cf6; --accent: #0ea5e9;
      --glass: rgba(0,0,0,0.06); --stroke: rgba(15,19,36,.12);
      --card: rgba(0,0,0,0.04); --shadow: 0 10px 24px rgba(2, 7, 26, .08);
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font:16px/1.5 Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;color:var(--text);background:var(--bg)}

    /* Background mesh */
    .bg{position:fixed;inset:-20vmax;z-index:-1;filter:blur(60px) saturate(140%);
      background:
        radial-gradient(40vmax 30vmax at 20% 10%, color-mix(in oklab, var(--brand) 75%, #00ddeb 25%), transparent 60%),
        radial-gradient(36vmax 30vmax at 85% 20%, color-mix(in oklab, var(--brand-2) 75%, #00ffaa 25%), transparent 60%),
        radial-gradient(34vmax 28vmax at 50% 92%, #00c2ff55, transparent 60%);
      animation:float 24s ease-in-out infinite alternate}
    @media (prefers-reduced-motion:reduce){.bg{animation:none}}
    @keyframes float{to{transform:translate3d(0,-30px,0) scale(1.02)}}

    .container{width:min(1200px,92vw);margin-inline:auto}

    /* Navbar */
    .navbar{position:sticky;top:0;z-index:50;display:flex;align-items:center;justify-content:space-between;padding:14px 0;backdrop-filter:blur(14px);border-bottom:1px solid var(--stroke);background:color-mix(in oklab, var(--bg) 72%, transparent)}
    .logo{display:flex;gap:10px;align-items:center;font-weight:800;letter-spacing:.2px}
    .logo-emoji{filter:drop-shadow(0 2px 8px #0006)}
    .nav-links a{margin-left:18px;color:var(--text);text-decoration:none;font-weight:600;opacity:.9}
    .nav-links a:hover{opacity:1}
    .btn{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:12px;border:1px solid var(--stroke);background:var(--card);color:var(--text);text-decoration:none;box-shadow:var(--shadow)}
    .btn:hover{transform:translateY(-1px)}

    /* Hero */
    .hero{display:grid;place-items:center;text-align:center;min-height:46vh;padding:24px 0}
    .hero h1{font-size:clamp(1.8rem,2.8vw+1rem,3rem);margin:0 0 8px;background:linear-gradient(45deg,#fff,#b8d1ff);-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent}
    .hero p{color:var(--muted);margin:0}

    /* Story + Stats */
    .story{background:var(--glass);border:1px solid var(--stroke);backdrop-filter:blur(14px);border-radius:16px;padding:20px;margin:24px 0}
    .story h2{margin:0 0 10px}
    .story p{color:var(--text);opacity:.95}

    .stats-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:14px;margin:22px 0}
    .stat-card{background:var(--card);border:1px solid var(--stroke);border-radius:14px;padding:16px;text-align:center;transition:transform .2s ease}
    .stat-card:hover{transform:translateY(-3px)}
    .stat-value{font-weight:800;font-size:1.6rem}
    .stat-label{color:var(--muted);font-size:.95rem}

    /* Charts */
    .charts-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(360px,1fr));gap:16px;margin:22px 0}
    .panel{background:var(--bg-2);border:1px solid var(--stroke);border-radius:16px;box-shadow:var(--shadow);padding:16px}
    .panel h3{margin:0 0 10px;color:var(--text)}
    .chart-wrap{position:relative;height:300px}

    /* Skills */
    .section-title{font-size:1.4rem;margin:14px 0;color:var(--text)}
    .skills-grid{background:var(--bg-2);border:1px solid var(--stroke);border-radius:16px;box-shadow:var(--shadow);padding:16px}
    .skills-list{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:10px}
    .skill-item{background:linear-gradient(135deg,var(--brand),var(--brand-2));color:#fff;padding:.75rem 1rem;border-radius:12px;display:flex;justify-content:space-between;align-items:center}

    /* Footer */
    footer{padding:28px 0;border-top:1px solid var(--stroke);text-align:center;color:var(--muted);background:color-mix(in oklab, var(--bg) 80%, transparent)}

    /* Utilities */
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}
    @media (max-width:768px){.container{padding:0 12px}.chart-wrap{height:260px}}
  </style>
</head>
<body>
  <div class="bg" aria-hidden="true"></div>
  <a href="#main" class="sr-only">Skip to content</a>

  <header class="navbar container">
    <div class="logo"><span class="logo-emoji" aria-hidden="true">ðŸ“Š</span> <span>Job Market Intelligence</span></div>
    <nav class="nav-links" aria-label="Primary">
      <a href="/">Dashboard</a>
      <a href="/skills">Skills</a>
      <a href="/salaries">Salaries</a>
      <a href="/companies">Companies</a>
      <button id="themeBtn" class="btn" type="button" title="Toggle theme">Theme</button>
    </nav>
  </header>

  <main id="main" class="container">
    <section class="hero">
      <h1>Live Market Dashboard</h1>
      <p>{{ summary.total_jobs if summary else '1,000' }} jobs analyzed across top tech regions</p>
    </section>

    <section class="story">
      <h2>Job Market Intelligence Platform</h2>
      <p>
        I built this comprehensive platform to analyze the modern tech job market through a realistic simulation of 1,000 job postings across major hubs.
        It tracks salary trends, skill demand, and company hiring behavior using data generation tuned to realâ€‘world patterns.
      </p>
      <div style="display:flex;flex-wrap:wrap;gap:8px;margin-top:10px">
        <span class="btn" style="background:var(--glass)">Python FastAPI</span>
        <span class="btn" style="background:var(--glass)">SQLAlchemy ORM</span>
        <span class="btn" style="background:var(--glass)">Jinja2 Templates</span>
        <span class="btn" style="background:var(--glass)">Chart.js</span>
      </div>
    </section>

    <section class="stats-grid">
      <div class="stat-card"><div class="stat-value">{{ summary.total_jobs if summary else '1,000' }}</div><div class="stat-label">Total Jobs</div></div>
      <div class="stat-card"><div class="stat-value">${{ "{:,}".format(summary.avg_salary|int if summary and summary.avg_salary else 89500) }}</div><div class="stat-label">Average Salary</div></div>
      <div class="stat-card"><div class="stat-value">{{ top_skills|length if top_skills else '25' }}</div><div class="stat-label">Skills Tracked</div></div>
      <div class="stat-card"><div class="stat-value" style="color:var(--accent)">Live</div><div class="stat-label">Data Status</div></div>
    </section>

    <section class="charts-grid">
      <article class="panel">
        <h3>ðŸ”¥ Top Skills Demand</h3>
        <div class="chart-wrap"><canvas id="skillsChart"></canvas></div>
      </article>
      <article class="panel">
        <h3>ðŸ“Š Skill Distribution</h3>
        <div class="chart-wrap"><canvas id="distributionChart"></canvas></div>
      </article>
    </section>

    <h2 class="section-title">ðŸ’» Most Inâ€‘Demand Technologies</h2>
    <section class="skills-grid">
      <div class="skills-list">
        {% if top_skills %}
          {% for skill in top_skills[:12] %}
            <div class="skill-item"><span>{{ skill.skill }}</span><span>{{ skill.job_count }} jobs</span></div>
          {% endfor %}
        {% else %}
          <div class="skill-item"><span>Python</span><span>245 jobs</span></div>
          <div class="skill-item"><span>JavaScript</span><span>203 jobs</span></div>
          <div class="skill-item"><span>React</span><span>178 jobs</span></div>
          <div class="skill-item"><span>AWS</span><span>156 jobs</span></div>
          <div class="skill-item"><span>Node.js</span><span>134 jobs</span></div>
          <div class="skill-item"><span>SQL</span><span>123 jobs</span></div>
        {% endif %}
      </div>
    </section>
  </main>

  <footer>
    <div class="container">Â© <span id="year"></span> Job Market Intelligence â€¢ Built for speed & clarity</div>
  </footer>

  <noscript><div style="text-align:center;padding:8px;background:#222;color:#fff">Enable JavaScript to view charts.</div></noscript>

  <script>
    // Theme toggle + persistence (respects system preference on first visit)
    const root = document.documentElement;
    try {
      const stored = localStorage.getItem('theme');
      if (!stored) {
        const prefersLight = window.matchMedia('(prefers-color-scheme: light)').matches;
        root.setAttribute('data-theme', prefersLight ? 'light' : 'dark');
      } else root.setAttribute('data-theme', stored);
    } catch (e) {}
    document.getElementById('themeBtn').addEventListener('click', () => {
      const next = root.getAttribute('data-theme') === 'light' ? 'dark' : 'light';
      root.setAttribute('data-theme', next);
      try { localStorage.setItem('theme', next); } catch (e) {}
    });

    // Year
    document.getElementById('year').textContent = new Date().getFullYear();

    // Data prep from Jinja/Fallback
    {% if top_skills %}
    const skillData = [
      {% for skill in top_skills[:6] %}{ name: "{{ skill.skill }}", count: {{ skill.job_count }} }{% if not loop.last %},{% endif %}{% endfor %}
    ];
    {% else %}
    const skillData = [
      {name: 'Python', count: 245}, {name: 'JavaScript', count: 203}, {name: 'React', count: 178},
      {name: 'AWS', count: 156}, {name: 'Node.js', count: 134}, {name: 'SQL', count: 123}
    ];
    {% endif %}

    const colors = ['#7aa2ff','#8a5cff','#f093fb','#f5576c','#4facfe','#00f2fe'];

    function safeChart(ctx, cfg){
      try { return new Chart(ctx, cfg); } catch (e) { console.error('Chart init failed', e); }
    }

    // Doughnut
    safeChart(document.getElementById('skillsChart'), {
      type: 'doughnut',
      data: { labels: skillData.map(s=>s.name), datasets: [{ data: skillData.map(s=>s.count), backgroundColor: colors, hoverOffset: 8, borderWidth: 0 }] },
      options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom', labels: { usePointStyle:true, padding: 12 } } } }
    });

    // Bar
    safeChart(document.getElementById('distributionChart'), {
      type: 'bar',
      data: { labels: skillData.map(s=>s.name), datasets: [{ label: 'Job Count', data: skillData.map(s=>s.count), backgroundColor: colors, borderRadius: 8, borderSkipped: false }] },
      options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { y: { beginAtZero: true }, x: { grid: { display: false } } } }
    });
  </script>
</body>
</html>
